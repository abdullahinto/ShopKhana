{% extends 'index.html' %}

{% block title %}
Order Placed - ShopKhana
{% endblock title %}

{% block extra_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/final_order.css') }}">
{% endblock extra_css %}

{% block extra_js %}
<script src="{{ url_for('static', filename='js/final_order.js') }}"></script>
{% endblock extra_js %}

{% block body %}
<!-- Main Heading -->
<h1 class="sk-final-heading">WOOHOO!</h1>

<!-- First Mini-Section: Order Placed -->
<div class="sk-final-section sk-final-section1 animate-on-view">
  <p class="sk-final-order-placed">
    Your order has been successfully placed.
  </p>
  <p class="sk-final-price">
    <span class="sk-final-rs-label">Rs.</span> <span id="skFinalTotalPrice">{{ order_details.payment_amount }}</span>
  </p>
  <p class="sk-final-order-number">
    Your order number is <strong id="skFinalOrderNum">{{ order_details.order_id }}</strong>
    <button id="copyOrderIdBtn" class="copy-btn">Copy</button>
  </p>
</div>

<div id="toastContainer" class="toast-container"></div>

<!-- Second Mini-Section -->
<div class="sk-final-section sk-final-section2 animate-on-view">
  <p class="sk-final-reminder">
    Please have this amount ready on delivery day.
  </p>
  <p class="sk-final-reminder-price">
    <span class="sk-final-rs-label">Rs.</span> <span id="skFinalRemindPrice">{{ order_details.payment_amount }}</span>
  </p>

  <!-- Delivery Info Container -->
  <div class="sk-final-delivery-info">
    <div class="sk-final-delivery-top">
      <div class="sk-final-delivery-date">
        <p>{{ order_details.estimated_delivery }}</p>
      </div>
      <div class="sk-final-delivery-thumb">
        <!-- Optionally, show a thumbnail of one of the products -->
        {% if order_details['items'] and order_details['items'][0]['title'] %}
        <img src="{{ url_for('static', filename='img/default_product.png') }}" alt="Product Thumbnail" />
        {% else %}
        <img src="{{ url_for('static', filename='img/p2.webp') }}" alt="Product Thumbnail" />
        {% endif %}
      </div>
    </div>
    <hr class="sk-final-grey-line" />
    <div class="sk-final-tracking-info">
      <p>
        To track the delivery of your order, click on your <strong>profile &gt; My Orders</strong>
        or click the button below:
      </p>
      <button class="sk-final-view-order-btn">View Order</button>
    </div>
  </div>

  <!-- Email Sent Container -->
  <div class="sk-final-email-sent animate-on-view">
    <i class="fas fa-envelope"></i>
    <p>
      Weâ€™ve sent a confirmation email to <strong>{{ order_details.user_email }}</strong>.
      Check your email inbox regularly to receive real-time updates of your order.
    </p>
    <p style="font-style: italic;">
      <strong>Note: </strong>Your order will be processed after <b>2 hours</b>. Please be aware that once your order is
      placed, it cannot be <b>canceled</b>.
    </p>
  </div>

  <!-- Order Summary Dropdown -->
  <div class="sk-final-summary-dropdown animate-on-view">
    <button id="skFinalSummaryToggle" class="sk-final-summary-btn">
      Order Summary <span id="skFinalSummaryIcon"><i class="fas fa-chevron-down"></i></span>
    </button>
    <div id="skFinalSummaryContent" class="sk-final-summary-content">
      <ul>
        {% for item in order_details['items'] %}
        <li>{{ item['title'] }}: Rs. {{ item['price'] }}</li>
        {% endfor %}
        <hr />
        <li><strong>Total: Rs. {{ order_details.payment_amount }}</strong></li>
      </ul>
    </div>
  </div>

  <!-- Continue Shopping Button -->
  <a style="text-decoration: none;" href="{{ url_for('main_page') }}" class="sk-final-continue-btn">
    Continue Shopping
  </a>
</div>
{% endblock body %}